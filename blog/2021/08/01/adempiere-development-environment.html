<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/main.css"><link rel="shortcut icon" href="/images/favicon.png"><title>搭建ADempiere开发环境</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1 class="topictitle1" id="ariaid-title1">搭建ADempiere开发环境</h1><time>01 Aug 2021</time><div><p>本文描述ADempiere基于Eclipse的开发环境搭建流程，如果只是试用，可以参考<a href="/blog/2021/07/25/adempiere-installation-and-configuration.html">这里</a>。</p><div class="section"><h2 class="sectiontitle">Swing UI开发环境</h2><ol><li><p>自https://www.microsoft.com/openjdk下载安装OpenJDK 11；</p></li><li><p>自https://www.eclipse.org/downloads/packages/release下载解压Eclipse 2021‑06 R（Eclipse IDE for Enterprise Java and Web Developers）；</p></li><li><p>调整eclipse.ini，更改<code>--vm</code>值为：<code>C:/Program Files/Microsoft/jdk-11.0.11.9-hotspot/bin</code>；</p></li><li><p>打开Eclipse，指定工作环境目录，如：C:/workspace/adempiere；</p></li><li><p>在Eclipse欢迎页面，点击Checkout projects from Git，选择Clone URI，指定URI为https://github.com/adempiere/adempiere.git，点击Next，目标目录指定为：C:/git/adempiere，再点击Next，完成仓库克隆；</p></li><li><p>点击Eclipse菜单Window &gt; Preferences，选择General &gt; Workspace，设置Text file encoding为UTF-8，New text file line delimiter为Unix；</p></li><li><p>点击Eclipse菜单File &gt; Import...，再选择General &gt; Existing Projects inot Workspace，点击Next，选择Root Directory，如：C:/git/adempiere（注：不要勾选Search for nested projects）；</p></li><li><p>搭建数据库，本文选择在WSL环境中搭建，PostgreSQL服务的安装过程从略，安装完成后，执行以下命令：</p><pre class="screen">% psql postgres postgres
# create role adempiere with login password 'adempiere' ;
# create database adempiere with owner adempiere ;
% cd /mnt/c/git/adempiere
% unzip -p data/seed/Adempiere_pg.jar Adempiere_pg.dmp | psql -d adempiere -U adempiere</pre></li><li><p>点击Eclipse菜单Run &gt; Run Configurations...，选择Java Application &gt; Load XML Migrations，点击Arguments标签页，更改VM arguments参数如下，再点击Run，填写数据库信息后，开始迁移数据库到最新版本：</p><pre class="screen">-DADEMPIERE_HOME=C:/git/adempiere</pre></li><li><p>点击Eclipse菜单Run &gt; Run Configurations...，选择Java Application &gt; ADempiere-all，点击Arguments标签页，更改VM arguments参数如下，再点击Run，可启动ADempiere客户端：</p><pre class="screen">-DPropertyFile=C:/git/adempiere/Adempiere.properties
-DADEMPIERE_HOME=C:/git/adempiere
-Dsun.java2d.uiScale=1
-Dswing.useSystemFontSettings=false
-Xms128M
-Xmx256M
-Dorg.adempiere.server.embedded=true</pre></li></ol></div><div class="section"><h2 class="sectiontitle">Web UI开发环境</h2><p>ADempiere Web UI开发环境，在以上Swing UI配置的基础上，再执行以下操作：</p><ol><li><p>点击Eclipse菜单Window &gt; Show View &gt; Servers，在Servers窗口点击其中链接启动新建Server流程；</p></li><li><p>服务器类型选择Apache &gt; Tomcat 9，点击Next后，Tomcat installation directory选择C:\git\adempiere\tomcat，随后点击Next，再点击Add All添加adempiere项目，再点击Finish；</p></li><li><p>在Servers窗口右键点击Tomcat v9.0 Server at localhost，点击Start，出现数据库设置对话框，直接忽略，等待超时退出；</p></li><li><p>此时在Run configurations...中已经新增Apache Tomcat项目，更改其中启动参数，添加<code>-DPropertyFile=C:/git/adempiere/Adempiere.properties -DADEMPIERE_HOME=C:/git/adempiere</code>；</p></li><li><p>从<span class="filepath">C:/git/adempiere/tools/lib</span>中拷贝以下jar包到目录<span class="filepath">C:/workspace/adempiere/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/adempiere/WEB-INF/lib</span>；</p><ul><li>commons-collections4</li><li>HikariCP</li><li>jasperreports-fonts</li><li>jasperreports</li><li>oracle</li><li>slf4j-api</li><li>slf4j-simple</li></ul><p>以及以下包，用于PDF报表生成：</p><ul><li>harness</li><li>itextpdf</li><li>itext-carriage</li><li>kernel</li><li>pdfa</li></ul><p>以及以下包，用于XLS报表生成：</p><ul><li>poi</li><li>poi-ooxml</li></ul></li><li>之后可在Run菜单中选择Tomcat v9.0 Server at localhost启动。</li></ol></div><div class="section"><h2 class="sectiontitle">命令行启动</h2><p>Swing客户端启动：</p><pre><code>"C:\Program Files\Microsoft\jdk-11.0.12.7-hotspot\bin\java.exe" -Dsun.java2d.uiScale=1.0  "-Dswing.plaf.metal.controlFont=Microsoft YaHei UI 14" "-Dswing.plaf.metal.menuFont=Microsoft YaHei UI 14" "-Dswing.plaf.metal.smallFont=Microsoft YaHei UI 14" "-Dswing.plaf.metal.systemFont=Microsoft YaHei UI 14" "-Dswing.plaf.metal.userFont=Microsoft YaHei UI 14" "-Dswing.plaf.metal.windowFont=Microsoft YaHei UI 14" -DPropertyFile=C:/git/adempiere/Adempiere.properties -DADEMPIERE_HOME=C:/git/adempiere -Xms128M -Xmx256M -Dorg.adempiere.server.embedded=true -Dfile.encoding=UTF-8 -classpath "C:\git\adempiere\base\test\build;C:\git\adempiere\serverRoot\test\build;C:\git\adempiere\org.eevolution.manufacturing\test\build;C:\git\adempiere\org.adempiere.asset\test\build;C:\git\adempiere\bin;C:\git\adempiere\tools\lib\*;C:\git\adempiere\JasperReportsTools\lib\*" org.compiere.Adempiere</code></pre><p>Web服务启动：</p><pre><code>set JAVA_HOME=C:\Program Files\Microsoft\jdk-11.0.12.7-hotspot
set CATALINA_HOME=C:\git\adempiere\tomcat
set CATALINA_BASE=C:\workspace\adempiere\.metadata\.plugins\org.eclipse.wst.server.core\tmp0
set CATALINA_OPTS=-DPropertyFile=C:/git/adempiere/Adempiere.properties -DADEMPIERE_HOME=C:/git/adempiere
C:\git\adempiere\tomcat\bin\catalina.bat run</code></pre></div><div class="section"><h2 class="sectiontitle">更新</h2><ul><li><p>2021-08-07</p><ol><li>简化JDK版本指定的处理，直接基于eclipse.ini实现；</li></ol></li><li><p>2021-08-15</p><ol><li>添加启动ADempiere时的高DPI缩放设置，以解决图片放大虚化问题；</li></ol></li><li><p>2021-08-21</p><ol><li>调整ADempiere-all参数；</li></ol></li><li><p>2021-09-05</p><ol><li>添加WebUI开发环境搭建说明；</li></ol></li><li><p>2021-10-16</p><ol><li>完善Web服务相关说明；</li><li>添加基于开发环境的App和Web启动说明；</li></ol></li></ul></div></div></article><footer><p>Copyright © 2021 Xin Wang</p></footer></body></html>