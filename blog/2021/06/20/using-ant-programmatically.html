<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/main.css"><link rel="shortcut icon" href="/images/favicon.png"><title>程序化使用Ant系统</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1 class="topictitle1" id="ariaid-title1">程序化使用Ant系统</h1><time>20 Jun 2021</time><div><div class="section"><p><a href="http://ant.apache.org/" target="_blank">Ant</a>作为早期的Java编译管理系统，一般是以命令行结合XML描述文件（<dfn class="term">build.xml</dfn>）的方式使用。实际上Ant有提供一套丰富的<a href="https://ant.apache.org/manual/api/" target="_blank">API接口</a>，可以实现程序化调用。</p><p>本文主要介绍Ant中较为核心的几个接口，作为入门指引。</p></div><div class="section"><h2 class="sectiontitle">项目（project）</h2><p>Ant以项目为单位进行编译任务的组织，一个<dfn class="term">project</dfn>对应于一份<dfn class="term">build.xml</dfn>描述文件。和项目相关的接口，重要的包括：</p><ul><li><code>Project.addBuildListener</code> - 结合<code>org.apache.tools.ant.DefaultLogger</code>实现日志记录（<code>DefaultLogger</code>的<code>setOutputPrintStream</code>和<code>setErrorPrintStream</code>接口配置日志输出流，<code>setMessageOutputLevel</code>接口调整日志输出等级）；</li><li><code>ProjectHelper.configureProject</code> - 加载<dfn class="term">build.xml</dfn>文件；</li><li><code>Project.setProperty</code> - 设置项目编译运行时属性；</li></ul><p>至于其他接口，可以查看<a href="https://ant.apache.org/manual/api/org/apache/tools/ant/Project.html" target="_blank">这里</a>详细的说明。</p><p><span>注意</span>：如果需要多次执行同一<dfn class="term">project</dfn>中的<dfn class="term">task</dfn>，每次都需要对<dfn class="term">project</dfn>重新实例化，否则可能出现冲突。</p></div><div class="section"><h2 class="sectiontitle">任务（task）</h2><p>在完成<dfn class="term">project</dfn>初始化后，就可以使用<code>Project.executeTarget</code>或<code>Project.executeTargets</code>接口执行其中的一个或多个特定任务了。</p></div><div class="section"><h2 class="sectiontitle">参考</h2><p>以下是一些应用了Ant的API接口的项目，可以作为参考：</p><ul><li><a href="https://github.com/dita-ot/dita-ot" target="_blank">DITA-OT</a> - <a href="https://github.com/dita-ot/dita-ot/blob/3.6.1/src/main/java/org/dita/dost/Processor.java" target="_blank"><code>org.dita.dost.Processor</code></a>基于Ant做了<span class="cmdname">dita</span>命令行的功能封装。</li></ul></div></div></article><footer><p>Copyright © 2021 Xin Wang</p></footer></body></html>