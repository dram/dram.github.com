<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/main.css"><link rel="shortcut icon" href="/images/favicon.png"><title>Odoo用户模块数据迁移（未完成）</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1 class="topictitle1" id="ariaid-title1">Odoo用户模块数据迁移（未完成）</h1><time>31 Jul 2021</time><div><p>部分插件会对res_users追加字段，连皮肤插件也是如此，所以不能单纯全字段导入导出；</p><p>导出users时，首先通过active字段做第一层筛选；</p><p>和res_users关联的res_partner数据同样需要导出；</p><p>通过以下代码导出的数据，仍然不完整，这块暂时搁置，以后有实现再继续研究：</p><pre class="screen">psql odoo-14.4-old odoo -c "update res_partner set write_uid = create_uid where active = true and id &lt;&gt; 2"

psql odoo-14.4-old odoo -c "copy (select * from res_partner where id = any(select partner_id from res_users where active = true and id &lt;&gt; 2)) to stdout" | psql odoo-14.4 odoo -c "copy res_partner from stdin"

psql odoo-14.4-old odoo -c "copy (select * from res_users where active = true and id &lt;&gt; 2) to stdout" | psql odoo-14.4 odoo -c "copy res_users from stdin"</pre></div></article><footer><p>Copyright © 2021 Xin Wang</p></footer></body></html>