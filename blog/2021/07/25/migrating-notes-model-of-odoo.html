<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/main.css"><link rel="shortcut icon" href="/images/favicon.png"><title>Odoo笔记模块数据迁移</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1 class="topictitle1" id="ariaid-title1">Odoo笔记模块数据迁移</h1><time>25 Jul 2021</time><div><p>本文介绍Odoo笔记模块数据从14.0迁移到14.4（15.0开发版）的流程，基于psql命令实现。</p><p>首先进入数据库容器的shell命令行环境，所有psql命令在此环境中执行：</p><pre class="screen">docker exec -it postgres sh</pre><p>第一步，复制stage数据：</p><pre class="screen">psql odoo-14.0 odoo -c "copy note_stage to stdout" | psql odoo-14.4 odoo -c "copy note_stage from stdin"</pre><p>第二步，复制attachment数据：</p><pre class="screen">psql odoo-14.0 odoo -c "copy (select * from ir_attachment where res_model = 'note.note') to stdout" | psql odoo-14.4 odoo -c "copy ir_attachment from stdin"</pre><p>第三步，复制note数据：</p><pre class="screen">psql odoo-14.0 odoo -c "copy note_note to stdout" | psql odoo-14.4 odoo -c "copy note_note from stdin"</pre><p>第四步，复制note和stage的关联数据：</p><pre class="screen">psql odoo-14.0 odoo -c "copy note_stage_rel to stdout" | psql odoo-14.4 odoo -c "copy note_stage_rel from stdin"</pre><p>另外，还需要迁移对应的sequence的值。</p></div></article><footer><p>Copyright © 2021 Xin Wang</p></footer></body></html>